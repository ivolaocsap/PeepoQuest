{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{useCallback}from'react';import{useTransactionAdder}from'../state/transactions/hooks';import{useAddPopup}from'../state/application/hooks';import WaitingApproval from'../components/WaitingApproval';import useModalWithFC from'./useModalWithFC';import{getErrorMessage}from'../utils/transactionError';import WaitingApprovalResult from'../components/WaitingApprovalResult';var useHandleTransactionReceipt=function useHandleTransactionReceipt(){var _useModalWithFC=useModalWithFC('approval'),showModal=_useModalWithFC.showModal,hideModal=_useModalWithFC.hideModal;var addTransaction=useTransactionAdder();var addPopup=useAddPopup();return useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(promise,summary,customData){var response,_getErrorMessage,title,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:showModal(WaitingApproval,{message:summary,onDismiss:hideModal});_context.prev=1;customData=customData||{};_context.next=5;return promise;case 5:response=_context.sent;showModal(WaitingApprovalResult,{onDismiss:hideModal,transactionHash:response.hash});addTransaction(response,_objectSpread(_objectSpread({},customData),{},{summary:summary}));return _context.abrupt(\"return\",{response:response,hideModal:hideModal});case 11:_context.prev=11;_context.t0=_context[\"catch\"](1);console.warn('Error handled',_context.t0);hideModal();_getErrorMessage=getErrorMessage(_context.t0,summary),title=_getErrorMessage.title,message=_getErrorMessage.message;addPopup({error:{message:message,title:title}});throw _context.t0;case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,11]]);}));return function(_x,_x2,_x3){return _ref.apply(this,arguments);};}(),[addPopup,addTransaction,showModal,hideModal]);};export default useHandleTransactionReceipt;","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/cuffies/src/hooks/useHandleTransactionReceipt.ts"],"names":["useCallback","useTransactionAdder","useAddPopup","WaitingApproval","useModalWithFC","getErrorMessage","WaitingApprovalResult","useHandleTransactionReceipt","showModal","hideModal","addTransaction","addPopup","promise","summary","customData","message","onDismiss","response","transactionHash","hash","console","warn","title","error"],"mappings":"ocAAA,OAASA,WAAT,KAA4B,OAA5B,CAEA,OAAgCC,mBAAhC,KAA2D,6BAA3D,CACA,OAASC,WAAT,KAA4B,4BAA5B,CACA,MAAOC,CAAAA,eAAP,KAA4B,+BAA5B,CACA,MAAOC,CAAAA,cAAP,KAA2B,kBAA3B,CACA,OAASC,eAAT,KAAgC,2BAAhC,CACA,MAAOC,CAAAA,qBAAP,KAAkC,qCAAlC,CAEA,GAAMC,CAAAA,2BAA2B,CAAG,QAA9BA,CAAAA,2BAA8B,EAAM,CACxC,oBAAiCH,cAAc,CAAC,UAAD,CAA/C,CAAQI,SAAR,iBAAQA,SAAR,CAAmBC,SAAnB,iBAAmBA,SAAnB,CACA,GAAMC,CAAAA,cAAc,CAAGT,mBAAmB,EAA1C,CACA,GAAMU,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CACA,MAAOF,CAAAA,WAAW,0FAChB,iBACEY,OADF,CAEEC,OAFF,CAGEC,UAHF,8JAKEN,SAAS,CAACL,eAAD,CAAkB,CACzBY,OAAO,CAAEF,OADgB,CAEzBG,SAAS,CAAEP,SAFc,CAAlB,CAAT,CALF,gBAUIK,UAAU,CAAGA,UAAU,EAAI,EAA3B,CAVJ,sBAW2BF,CAAAA,OAX3B,QAWUK,QAXV,eAYIT,SAAS,CAACF,qBAAD,CAAwB,CAC/BU,SAAS,CAAEP,SADoB,CAE/BS,eAAe,CAAED,QAAQ,CAACE,IAFK,CAAxB,CAAT,CAIAT,cAAc,CAACO,QAAD,gCAAgBH,UAAhB,MAA4BD,OAAO,CAAPA,OAA5B,GAAd,CAhBJ,gCAiBW,CAAEI,QAAQ,CAARA,QAAF,CAAYR,SAAS,CAATA,SAAZ,CAjBX,4DAmBIW,OAAO,CAACC,IAAR,CAAa,eAAb,cACAZ,SAAS,GApBb,iBAqB+BJ,eAAe,aAAMQ,OAAN,CArB9C,CAqBYS,KArBZ,kBAqBYA,KArBZ,CAqBmBP,OArBnB,kBAqBmBA,OArBnB,CAsBIJ,QAAQ,CAAC,CAAEY,KAAK,CAAE,CAAER,OAAO,CAAPA,OAAF,CAAWO,KAAK,CAALA,KAAX,CAAT,CAAD,CAAR,CAtBJ,uFADgB,uEA2BhB,CAACX,QAAD,CAAWD,cAAX,CAA2BF,SAA3B,CAAsCC,SAAtC,CA3BgB,CAAlB,CA6BD,CAjCD,CAmCA,cAAeF,CAAAA,2BAAf","sourcesContent":["import { useCallback } from 'react';\nimport { TransactionResponse } from '@ethersproject/providers';\nimport { TransactionCustomData, useTransactionAdder } from '../state/transactions/hooks';\nimport { useAddPopup } from '../state/application/hooks';\nimport WaitingApproval from '../components/WaitingApproval';\nimport useModalWithFC from './useModalWithFC';\nimport { getErrorMessage } from '../utils/transactionError';\nimport WaitingApprovalResult from '../components/WaitingApprovalResult';\n\nconst useHandleTransactionReceipt = () => {\n  const { showModal, hideModal } = useModalWithFC('approval');\n  const addTransaction = useTransactionAdder();\n  const addPopup = useAddPopup();\n  return useCallback(\n    async (\n      promise: Promise<TransactionResponse>,\n      summary: string,\n      customData?: TransactionCustomData,\n    ) => {\n      showModal(WaitingApproval, {\n        message: summary,\n        onDismiss: hideModal,\n      });\n      try {\n        customData = customData || {};\n        const response = await promise;\n        showModal(WaitingApprovalResult, {\n          onDismiss: hideModal,\n          transactionHash: response.hash,\n        });\n        addTransaction(response, { ...customData, summary });\n        return { response, hideModal };\n      } catch (err) {\n        console.warn('Error handled', err);\n        hideModal();\n        const { title, message } = getErrorMessage(err, summary);\n        addPopup({ error: { message, title } });\n        throw err;\n      }\n    },\n    [addPopup, addTransaction, showModal, hideModal],\n  );\n};\n\nexport default useHandleTransactionReceipt;\n"]},"metadata":{},"sourceType":"module"}