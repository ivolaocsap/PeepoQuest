{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _defineProperty from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3;import React,{useEffect,useMemo}from'react';import styled from'styled-components';import Identicon from'identicon.js';import{useSavedConnector}from'src/state/application/hooks';import{useWeb3React}from'@web3-react/core';import useWalletConnectors from'src/hooks/useWalletConnectors';import useTryConnect from'src/hooks/useTryConnect';import{useConfiguration}from'src/contexts/ConfigProvider/ConfigProvider';import useModal from'src/hooks/useModal';import AccountModal from'./AccountModal';import Spacer from'../Spacer';import{useAllTransactions}from'src/state/transactions/hooks';import Loading from'../Loading';import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{faSatelliteDish}from\"@fortawesome/free-solid-svg-icons\";import{ConnectorNames}from'src/state/application/reducer';import{library}from'@fortawesome/fontawesome-svg-core';import{NetworkConnector}from'src/libs/NetworkConnector';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var isMetaMaskConnected=function isMetaMaskConnected(){if(typeof window.ethereum!=='undefined'&&window.ethereum.isMetaMask&&window.ethereum._metamask&&typeof window.ethereum._metamask.isUnlocked==='function'){return window.ethereum._metamask.isUnlocked();}return Promise.resolve(false);};var AccountButton=function AccountButton(){var _useWeb3React=useWeb3React(),account=_useWeb3React.account,activate=_useWeb3React.activate,connector=_useWeb3React.connector,deactivate=_useWeb3React.deactivate;var _useModal=useModal(/*#__PURE__*/_jsx(AccountModal,{})),_useModal2=_slicedToArray(_useModal,1),onPresentAccountModal=_useModal2[0];var _useTryConnect=useTryConnect(),tryConnect=_useTryConnect.tryConnect;var savedConnector=useSavedConnector();var connectors=useWalletConnectors();var allTransactions=useAllTransactions();var _useConfiguration=useConfiguration(),chainId=_useConfiguration.chainId,defaultProvider=_useConfiguration.defaultProvider;var defaultConnector=useMemo(function(){return new NetworkConnector({urls:_defineProperty({},chainId,Array.isArray(defaultProvider)?defaultProvider[0]:defaultProvider),defaultChainId:chainId});},[chainId,defaultProvider]);var hasPendingTransaction=useMemo(function(){var txs=Object.values(allTransactions);return txs.filter(function(tx){return!tx.receipt;}).length>0;},[allTransactions]);useEffect(function(){if(!account&&!savedConnector){activate(defaultConnector);return;}if(!account&&savedConnector&&connectors[savedConnector]){if(savedConnector===ConnectorNames.Injected){isMetaMaskConnected().then(function(connected){if(connected){activate(connectors[savedConnector],function(error){console.log('error',error);activate(defaultConnector);});}else{activate(defaultConnector);}});}else{activate(connectors[savedConnector],function(error){console.log('error',error);activate(defaultConnector);});}}},[account,activate,connectors,deactivate,defaultConnector,savedConnector]);useEffect(function(){if(connector){var onChange=function onChange(){window.location.reload();};connector.addListener('Web3ReactUpdate',onChange);return function(){connector.removeListener('Web3ReactUpdate',onChange);};}},[connector]);var iconAccount=useMemo(function(){if(account){var data=new Identicon(account,{size:48,foreground:[50,197,255,255],background:[0,0,0,0],format:'svg'}).toString();return\"data:image/svg+xml;base64,\".concat(data);}},[account]);var shortenAccount=useMemo(function(){if(account&&account.length>0){return\"\".concat(account.substring(0,4),\".....\").concat(account.substring(account.length-4,account.length));}},[account]);return/*#__PURE__*/_jsx(StyledAccountButton,{active:!!library,children:account?/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline\",onClick:onPresentAccountModal,children:/*#__PURE__*/_jsxs(AccountInfo,{children:[/*#__PURE__*/_jsx(\"img\",{src:iconAccount}),hasPendingTransaction&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Spacer,{size:\"sm\"}),/*#__PURE__*/_jsx(Loading,{size:\"18px\",color:\"#ffffff\"})]}),/*#__PURE__*/_jsx(Spacer,{size:\"xs\"}),/*#__PURE__*/_jsx(AccountNumber,{children:shortenAccount})]})}):!library?/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline\",children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faSatelliteDish,style:{marginRight:'5px'}}),/*#__PURE__*/_jsx(\"span\",{className:\"d-none d-lg-inline\",children:\"Waiting for network\"})]}):/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:function onClick(){return tryConnect();},children:\"Connect\"})});};var StyledAccountButton=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  background: transparent;\\n\"])));var AccountInfo=styled.span(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  img {\\n    width: 24px;\\n    height: auto;\\n    border-radius: 100%;\\n  }\\n\"])));var AccountNumber=styled.span(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin-right: 10px;\\n  text-transform: lowercase;\\n  @media (max-width: 1070px) {\\n    display: none;\\n  }\\n\\n  @media (max-width: \",\") {\\n    display: none;\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.breakpoints.md;});export default AccountButton;","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/cuffies/src/components/Header/AccountButton.tsx"],"names":["React","useEffect","useMemo","styled","Identicon","useSavedConnector","useWeb3React","useWalletConnectors","useTryConnect","useConfiguration","useModal","AccountModal","Spacer","useAllTransactions","Loading","FontAwesomeIcon","faSatelliteDish","ConnectorNames","library","NetworkConnector","isMetaMaskConnected","window","ethereum","isMetaMask","_metamask","isUnlocked","Promise","resolve","AccountButton","account","activate","connector","deactivate","onPresentAccountModal","tryConnect","savedConnector","connectors","allTransactions","chainId","defaultProvider","defaultConnector","urls","Array","isArray","defaultChainId","hasPendingTransaction","txs","Object","values","filter","tx","receipt","length","Injected","then","connected","error","console","log","onChange","location","reload","addListener","removeListener","iconAccount","data","size","foreground","background","format","toString","shortenAccount","substring","marginRight","StyledAccountButton","div","AccountInfo","span","AccountNumber","theme","breakpoints","md"],"mappings":"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","sourcesContent":["import React, { useEffect, useMemo } from 'react';\nimport styled from 'styled-components';\nimport Identicon from 'identicon.js';\nimport { useSavedConnector } from 'src/state/application/hooks';\nimport { useWeb3React } from '@web3-react/core';\nimport useWalletConnectors from 'src/hooks/useWalletConnectors';\nimport { Web3Provider } from '@ethersproject/providers';\nimport useTryConnect from 'src/hooks/useTryConnect';\nimport { useConfiguration } from 'src/contexts/ConfigProvider/ConfigProvider';\nimport useModal from 'src/hooks/useModal';\nimport AccountModal from './AccountModal';\nimport Spacer from '../Spacer';\nimport { useAllTransactions } from 'src/state/transactions/hooks';\nimport Loading from '../Loading';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport { faSatelliteDish } from \"@fortawesome/free-solid-svg-icons\";\nimport { ConnectorNames } from 'src/state/application/reducer';\nimport { library } from '@fortawesome/fontawesome-svg-core';\nimport { NetworkConnector } from 'src/libs/NetworkConnector';\n\nconst isMetaMaskConnected = () => {\n  if (\n    typeof window.ethereum !== 'undefined' &&\n    window.ethereum.isMetaMask &&\n    window.ethereum._metamask &&\n    typeof window.ethereum._metamask.isUnlocked === 'function'\n  ) {\n    return window.ethereum._metamask.isUnlocked();\n  }\n\n  return Promise.resolve(false);\n};\n\nconst AccountButton: React.FC = () => {\n  const { account, activate, connector, deactivate } = useWeb3React<Web3Provider>();\n  const [onPresentAccountModal] = useModal(<AccountModal />);\n  const { tryConnect } = useTryConnect();\n  const savedConnector = useSavedConnector();\n  const connectors = useWalletConnectors();\n  const allTransactions = useAllTransactions();\n  const { chainId, defaultProvider } = useConfiguration();\n\n  const defaultConnector = useMemo(\n    () =>\n      new NetworkConnector({\n        urls: {\n          [chainId]: Array.isArray(defaultProvider) ? defaultProvider[0] : defaultProvider,\n        },\n        defaultChainId: chainId,\n      }),\n    [chainId, defaultProvider],\n  );\n\n  const hasPendingTransaction = useMemo(() => {\n    const txs = Object.values(allTransactions);\n    return txs.filter((tx) => !tx.receipt).length > 0;\n  }, [allTransactions]);\n\n  useEffect(() => {\n    if (!account && !savedConnector) {\n      activate(defaultConnector);\n      return;\n    }\n\n    if (!account && savedConnector && connectors[savedConnector]) {\n      if (savedConnector === ConnectorNames.Injected) {\n        isMetaMaskConnected().then((connected) => {\n          if (connected) {\n            activate(connectors[savedConnector], (error) => {\n              console.log('error', error);\n              activate(defaultConnector);\n            });\n          } else {\n            activate(defaultConnector);\n          }\n        });\n      } else {\n        activate(connectors[savedConnector], (error) => {\n          console.log('error', error);\n          activate(defaultConnector);\n        });\n      }\n    }\n  }, [account, activate, connectors, deactivate, defaultConnector, savedConnector]);\n\n  useEffect(() => {\n    if (connector) {\n      const onChange = () => {\n        window.location.reload();\n      };\n      connector.addListener('Web3ReactUpdate', onChange);\n\n      return () => {\n        connector.removeListener('Web3ReactUpdate', onChange);\n      };\n    }\n  }, [connector]);\n\n  const iconAccount = useMemo(() => {\n    if (account) {\n      const data = new Identicon(account, {\n        size: 48,\n        foreground: [50, 197, 255, 255],\n        background: [0, 0, 0, 0],\n        format: 'svg',\n      }).toString();\n      return `data:image/svg+xml;base64,${data}`;\n    }\n  }, [account]);\n\n  const shortenAccount = useMemo(() => {\n    if (account && account.length > 0) {\n      return `${account.substring(0, 4)}.....${account.substring(\n        account.length - 4,\n        account.length,\n      )}`;\n    }\n  }, [account]);\n\n  return (\n    <StyledAccountButton active={!!library}>\n      {account ? (\n        <button className=\"btn btn-outline\" onClick={onPresentAccountModal}>\n          <AccountInfo>\n            <img src={iconAccount} />\n            {hasPendingTransaction && (\n              <>\n                <Spacer size=\"sm\" />\n                <Loading size=\"18px\" color=\"#ffffff\" />\n              </>\n            )}\n            <Spacer size=\"xs\" />\n            <AccountNumber>{shortenAccount}</AccountNumber>\n          </AccountInfo>\n        </button>\n      ) : !library ? (\n        <button className=\"btn btn-outline\">\n          <FontAwesomeIcon icon={faSatelliteDish} style={{ marginRight: '5px' }} />\n          <span className=\"d-none d-lg-inline\">Waiting for network</span>\n        </button>\n      ) : (\n        <button className=\"btn\" onClick={() => tryConnect()}>\n          Connect\n        </button>\n      )}\n    </StyledAccountButton>\n  );\n};\n\nconst StyledAccountButton = styled.div<{ active?: boolean }>`\n  background: transparent;\n`;\n\nconst AccountInfo = styled.span`\n  display: flex;\n  align-items: center;\n  img {\n    width: 24px;\n    height: auto;\n    border-radius: 100%;\n  }\n`;\n\nconst AccountNumber = styled.span`\n  margin-right: 10px;\n  text-transform: lowercase;\n  @media (max-width: 1070px) {\n    display: none;\n  }\n\n  @media (max-width: ${({ theme }) => theme.breakpoints.md}) {\n    display: none;\n  }\n`;\n\nexport default AccountButton;\n"]},"metadata":{},"sourceType":"module"}