{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject;import React,{useCallback,useEffect,useMemo,useState}from'react';import{ButtonAction}from'src/components/ButtonAction';import styled from'styled-components';import useDiamondHand from'src/hooks/useDiamondHand';import useHandleTransactionReceipt from'src/hooks/useHandleTransactionReceipt';import{useConfiguration}from'src/contexts/ConfigProvider/ConfigProvider';import{useTokenBalance}from'src/contexts/AccountBalanceProvider/AccountBalanceProvider';import useApprove,{ApprovalState}from'src/hooks/useApprove';import{jsx as _jsx}from\"react/jsx-runtime\";var ButtonStatus;(function(ButtonStatus){ButtonStatus[ButtonStatus[\"notConnected\"]=1]=\"notConnected\";ButtonStatus[ButtonStatus[\"insufficient\"]=2]=\"insufficient\";ButtonStatus[ButtonStatus[\"requireApproval\"]=3]=\"requireApproval\";ButtonStatus[ButtonStatus[\"approvalPending\"]=4]=\"approvalPending\";ButtonStatus[ButtonStatus[\"paused\"]=15]=\"paused\";ButtonStatus[ButtonStatus[\"ready\"]=20]=\"ready\";ButtonStatus[ButtonStatus[\"notEnough\"]=21]=\"notEnough\";})(ButtonStatus||(ButtonStatus={}));export var ButtonVest=function ButtonVest(_ref){var amount=_ref.amount;var dh=useDiamondHand();var handleTransactionReceipt=useHandleTransactionReceipt();var config=useConfiguration();var _useState=useState(),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var balance=useTokenBalance(token);useEffect(function(){if(!dh||token)return;setToken(dh.WBNB);},[dh,token]);var buyAddress=useMemo(function(){var _config$addresses;if(!config){return;}return config===null||config===void 0?void 0:(_config$addresses=config.addresses)===null||_config$addresses===void 0?void 0:_config$addresses.EarlySale;},[config]);var _useApprove=useApprove(token,buyAddress),_useApprove2=_slicedToArray(_useApprove,2),approvalTokenState=_useApprove2[0],approveToken=_useApprove2[1];var stake=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _dh$EARLYSALE,tx;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return handleTransactionReceipt((_dh$EARLYSALE=dh.EARLYSALE)===null||_dh$EARLYSALE===void 0?void 0:_dh$EARLYSALE.VestmyCuffies(amount),\"Buy Vested Cuffies\");case 3:tx=_context.sent;if(!(tx&&tx.response)){_context.next=8;break;}_context.next=7;return tx.response.wait();case 7:tx.hideModal();case 8:_context.next=12;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function stake(){return _ref2.apply(this,arguments);};}();var status=useMemo(function(){if(approvalTokenState==ApprovalState.PENDING){return ButtonStatus.approvalPending;}if(approvalTokenState!==ApprovalState.APPROVED){return ButtonStatus.requireApproval;}return ButtonStatus.ready;},[approvalTokenState,balance]);var buttonText=useMemo(function(){switch(status){case ButtonStatus.approvalPending:return\"Approving \".concat(token===null||token===void 0?void 0:token.symbol,\"...\");case ButtonStatus.requireApproval:return'Approve';default:return'Buy';}},[status,token]);var onClickBuy=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=status;_context2.next=_context2.t0===ButtonStatus.requireApproval?3:_context2.t0===ButtonStatus.approvalPending?6:_context2.t0===ButtonStatus.ready?7:9;break;case 3:_context2.next=5;return approveToken();case 5:return _context2.abrupt(\"break\",9);case 6:return _context2.abrupt(\"break\",9);case 7:stake();return _context2.abrupt(\"break\",9);case 9:case\"end\":return _context2.stop();}}},_callee2);})),[status,approveToken,stake]);return/*#__PURE__*/_jsx(StyledButtonAction,{onClick:onClickBuy,children:buttonText});};var StyledButtonAction=styled(ButtonAction)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: inline-block;\\n  width: initial;\\n  text-color: #f4b5d2;\\n  background-color: #fcdcf2;\\n  :hover {\\n    background-color:#a1118b;\\n  }\\n\"])));","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/cuffies/src/views/Farms/ButtonVest.tsx"],"names":["React","useCallback","useEffect","useMemo","useState","ButtonAction","styled","useDiamondHand","useHandleTransactionReceipt","useConfiguration","useTokenBalance","useApprove","ApprovalState","ButtonStatus","ButtonVest","amount","dh","handleTransactionReceipt","config","token","setToken","balance","WBNB","buyAddress","addresses","EarlySale","approvalTokenState","approveToken","stake","EARLYSALE","VestmyCuffies","tx","response","wait","hideModal","status","PENDING","approvalPending","APPROVED","requireApproval","ready","buttonText","symbol","onClickBuy","StyledButtonAction"],"mappings":"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","sourcesContent":["import React, { forwardRef,useCallback, useEffect, useMemo, useState }  from 'react';\nimport { ButtonAction } from 'src/components/ButtonAction';\nimport { BigNumber } from '@ethersproject/bignumber';\nimport styled from 'styled-components';\nimport useDiamondHand from 'src/hooks/useDiamondHand';\nimport useHandleTransactionReceipt from 'src/hooks/useHandleTransactionReceipt';\nimport { useConfiguration } from 'src/contexts/ConfigProvider/ConfigProvider';\nimport { useTokenBalance } from 'src/contexts/AccountBalanceProvider/AccountBalanceProvider';\nimport useApprove, { ApprovalState } from 'src/hooks/useApprove';\nimport ERC20 from 'src/diamondhand/ERC20';\n\nenum ButtonStatus {\n  notConnected = 1,\n  insufficient = 2,\n  requireApproval = 3,\n  approvalPending = 4,\n  paused = 15,\n  ready = 20,\n  notEnough = 21,\n}\n\ninterface ButtonStakeProps {\n  amount?: BigNumber;\n}\n\nexport const ButtonVest: React.ForwardRefRenderFunction<unknown, ButtonStakeProps> = ({ amount }) => {\n\n  const dh = useDiamondHand();\n  const handleTransactionReceipt = useHandleTransactionReceipt();\n  const config = useConfiguration();\n  const [token, setToken] = useState<ERC20 | undefined>();\nconst balance = useTokenBalance(token);\n\nuseEffect(() => {\n  if (!dh || token) return;\n  setToken(dh.WBNB);\n}, [dh, token]);\n\nconst buyAddress = useMemo(() => {\n  if (!config) {\n    return;\n  }\n  return config?.addresses?.EarlySale;\n}, [config]);\n\nconst [approvalTokenState, approveToken] = useApprove(token, buyAddress);\n\n  const stake = async () => {\n    try {\n      const tx = await handleTransactionReceipt(\n        dh.EARLYSALE?.VestmyCuffies(amount),\n        `Buy Vested Cuffies`,\n      );\n      if (tx && tx.response) {\n        await tx.response.wait();\n        tx.hideModal();\n      }\n    } catch {\n      //\n    }\n  };\n\n  const status = useMemo(() => {\n\n\n    if (approvalTokenState == ApprovalState.PENDING) {\n      return ButtonStatus.approvalPending;\n    }\n\n    if (approvalTokenState !== ApprovalState.APPROVED) {\n      return ButtonStatus.requireApproval;\n    }\n\n    return ButtonStatus.ready;\n  }, [approvalTokenState, balance]);\n\n  const buttonText = useMemo(() => {\n    switch (status) {\n      case ButtonStatus.approvalPending:\n        return `Approving ${token?.symbol}...`;\n\n      case ButtonStatus.requireApproval:\n        return 'Approve';\n      default:\n        return 'Buy';\n    }\n  }, [status, token]);\n\n\n  const onClickBuy = useCallback(async () => {\n    switch (status) {\n      case ButtonStatus.requireApproval:\n        await approveToken();\n        break;\n      case ButtonStatus.approvalPending:\n        break;\n      case ButtonStatus.ready:\n        stake();\n        break;\n    }\n  }, [status,  approveToken, stake]);\n\n  return <StyledButtonAction onClick={onClickBuy}>{buttonText}</StyledButtonAction>;\n};\n\nconst StyledButtonAction = styled(ButtonAction)`\n  display: inline-block;\n  width: initial;\n  text-color: #f4b5d2;\n  background-color: #fcdcf2;\n  :hover {\n    background-color:#a1118b;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}