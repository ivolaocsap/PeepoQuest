{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/Users/ivopascoal/Desktop/cuffies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12;import React,{useCallback,useEffect,useMemo,useState}from'react';import{Box,BoxHeader}from'src/components/Box';import Container from'src/components/Container';import Page from'src/components/Page';import styled from'styled-components';import imageTicket from\"../../assets/img/ticket-white.svg\";import imageWin from'../../assets/img/image-win.webp';import imageClock from'../../assets/img/img-clock.png';import ImgBallNormal from\"src/assets/img/ball-normal-large.svg\";import ImgBallPower from\"src/assets/img/ball-power-large.svg\";import bgRound from'../../assets/img/bg_confirm.png';import NumberDisplay from'src/components/Number';import NextDrawCountdown from'../DragonBall/components/NextDrawCountdown';import useDiamondHand from'src/hooks/useDiamondHand';import TicketClaim from'./components/TicketClaim';import useRoundInfo from'./hooks/useRoundInfo';import{useHistory}from'react-router-dom';import useQuery from'src/hooks/useQuery';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Status;(function(Status){Status[Status[\"NotStarted\"]=0]=\"NotStarted\";Status[Status[\"Open\"]=1]=\"Open\";Status[Status[\"Closed\"]=2]=\"Closed\";Status[Status[\"Completed\"]=3]=\"Completed\";})(Status||(Status={}));var TicketDetail=function TicketDetail(){var _lotteryInfo$winningN,_lotteryInfo$winners$,_lotteryInfo$winners$2,_lotteryInfo$winners$3,_lotteryInfo$winners$4,_lotteryInfo$winners$5,_lotteryInfo$winners$6;var dh=useDiamondHand();var history=useHistory();var query=useQuery();var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),currentRound=_useState2[0],setCurentRound=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),roundId=_useState4[0],setRoundId=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),currentPrize=_useState6[0],setCurrentPrize=_useState6[1];var lotteryInfo=useRoundInfo(roundId);useEffect(function(){var lotteryId=query===null||query===void 0?void 0:query.get('lotteryId');setRoundId(parseInt(lotteryId)||0);},[query]);useEffect(function(){var _dh$LOTTERY,_dh$LOTTERY2;if(!dh)return;dh===null||dh===void 0?void 0:(_dh$LOTTERY=dh.LOTTERY)===null||_dh$LOTTERY===void 0?void 0:_dh$LOTTERY.getCurrentLotto().then(function(data){setCurentRound(data.lotteryID.toNumber());});dh===null||dh===void 0?void 0:(_dh$LOTTERY2=dh.LOTTERY)===null||_dh$LOTTERY2===void 0?void 0:_dh$LOTTERY2.getCurrentPrizes().then(function(prizes){setCurrentPrize(prizes);});},[dh,history,roundId]);var closing=useMemo(function(){if(!lotteryInfo){return;}return lotteryInfo.closingTimestamp.toNumber()*1000;},[lotteryInfo]);var isPastClosing=useMemo(function(){var now=Date.now();if(closing){return now-closing>0;}},[closing]);var tickets=useMemo(function(){var temp=[];if(!currentRound){return temp;}for(var i=1;i<=currentRound;i++){temp.push(i);}return temp;},[currentRound]);var isClose=useMemo(function(){if(!lotteryInfo){return false;}return lotteryInfo.lotteryStatus===Status.Completed;},[lotteryInfo]);var onSelect=useCallback(function(event){history.push(\"?lotteryId=\".concat(event.target.value));},[history]);return/*#__PURE__*/_jsx(Page,{children:/*#__PURE__*/_jsxs(Container,{size:\"lg\",children:[/*#__PURE__*/_jsxs(StyledHeader,{children:[/*#__PURE__*/_jsx(\"img\",{src:imageTicket}),\"RESULTS\",/*#__PURE__*/_jsx(StyledSelect,{value:roundId,onChange:onSelect,children:tickets.map(function(item,index){return/*#__PURE__*/_jsxs(\"option\",{value:item,children:[\"Round \",item]},index);})})]}),/*#__PURE__*/_jsx(StyledContent,{children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(BoxHeader,{children:[/*#__PURE__*/_jsxs(BoxTitle,{children:[\"Round \",roundId]}),/*#__PURE__*/_jsxs(StyledNumberTicket,{children:[\"Total of\\xA0\",/*#__PURE__*/_jsx(NumberDisplay,{value:lotteryInfo===null||lotteryInfo===void 0?void 0:lotteryInfo.numberOfTickets,decimals:0,precision:0,keepZeros:true}),\"\\xA0Tickets\"]})]}),/*#__PURE__*/_jsx(BoxBody,{children:/*#__PURE__*/_jsxs(StyledBoxContent,{children:[/*#__PURE__*/_jsxs(StyledRound,{children:[/*#__PURE__*/_jsx(\"img\",{src:isClose?imageWin:imageClock}),isClose?'Winning Emojis':'Winning Emojis will be drawn in']}),isClose?/*#__PURE__*/_jsx(StyledWinNumber,{children:lotteryInfo===null||lotteryInfo===void 0?void 0:(_lotteryInfo$winningN=lotteryInfo.winningNumbers)===null||_lotteryInfo$winningN===void 0?void 0:_lotteryInfo$winningN.map(function(item,index){return/*#__PURE__*/_jsx(StyledWinNumberItem,{children:item||0},index);})}):/*#__PURE__*/_jsx(StyledCountdown,{children:isPastClosing?/*#__PURE__*/_jsx(\"div\",{children:\"Awaiting for results...\"}):/*#__PURE__*/_jsx(NextDrawCountdown,{to:closing?new Date(closing):undefined})}),/*#__PURE__*/_jsxs(StyledTable,{compact:!isClose,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Reward\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Reward Size\"}),isClose&&/*#__PURE__*/_jsx(\"th\",{children:\"Winners\"})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"JackPot\"}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(NumberDisplay,{value:roundId===currentRound&&!isClose?currentPrize[0]:lotteryInfo===null||lotteryInfo===void 0?void 0:lotteryInfo.prizes[0],decimals:18,precision:0,keepZeros:true}),/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0Cuffies\"})]}),isClose&&/*#__PURE__*/_jsx(\"td\",{children:(_lotteryInfo$winners$=lotteryInfo===null||lotteryInfo===void 0?void 0:(_lotteryInfo$winners$2=lotteryInfo.winners[0])===null||_lotteryInfo$winners$2===void 0?void 0:_lotteryInfo$winners$2.toString())!==null&&_lotteryInfo$winners$!==void 0?_lotteryInfo$winners$:0})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Match 4\"}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(NumberDisplay,{value:roundId===currentRound&&!isClose?currentPrize[1]:lotteryInfo===null||lotteryInfo===void 0?void 0:lotteryInfo.prizes[1],decimals:18,precision:0,keepZeros:true}),/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0Cuffies\"})]}),isClose&&/*#__PURE__*/_jsx(\"td\",{children:(_lotteryInfo$winners$3=lotteryInfo===null||lotteryInfo===void 0?void 0:(_lotteryInfo$winners$4=lotteryInfo.winners[1])===null||_lotteryInfo$winners$4===void 0?void 0:_lotteryInfo$winners$4.toString())!==null&&_lotteryInfo$winners$3!==void 0?_lotteryInfo$winners$3:0})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"Match 3\"}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(NumberDisplay,{value:roundId===currentRound&&!isClose?currentPrize[2]:lotteryInfo===null||lotteryInfo===void 0?void 0:lotteryInfo.prizes[2],decimals:18,precision:0,keepZeros:true}),/*#__PURE__*/_jsx(\"span\",{children:\"\\xA0Cuffies\"})]}),isClose&&/*#__PURE__*/_jsx(\"td\",{children:(_lotteryInfo$winners$5=lotteryInfo===null||lotteryInfo===void 0?void 0:(_lotteryInfo$winners$6=lotteryInfo.winners[2])===null||_lotteryInfo$winners$6===void 0?void 0:_lotteryInfo$winners$6.toString())!==null&&_lotteryInfo$winners$5!==void 0?_lotteryInfo$winners$5:0})]})]})]}),lotteryInfo&&/*#__PURE__*/_jsx(TicketClaim,{roundId:roundId,isCloseRound:isClose})]})})]})})]})});};export default TicketDetail;var StyledHeader=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  font-size: 32px;\\n  font-weight: 600;\\n  font-family: \",\";\\n  border-bottom: 2px dashed #303030;\\n  padding: 20px 0px 16px 0px;\\n  img {\\n    width: 38px;\\n    margin-right: 12px;\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.font.heading;});var StyledSelect=styled.select(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin-left: auto;\\n  padding: 5px 6px;\\n  border: solid 2px #12161e;\\n  background-color: #12161e;\\n  font-size: 16px;\\n  font-weight: 600;\\n  color: #ffffff;\\n\"])));var StyledContent=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin: 27px 60px 0px 60px;\\n  @media (max-width: \",\") {\\n    margin: 27px 0px 0px 0px;\\n  }\\n\"])),function(_ref2){var theme=_ref2.theme;return theme.breakpoints.lg;});var BoxTitle=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-family: \",\";\\n  font-size: 24px;\\n  font-weight: 600;\\n\"])),function(_ref3){var theme=_ref3.theme;return theme.font.heading;});var StyledNumberTicket=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  margin-left: auto;\\n  font-size: 16px;\\n  font-weight: 600;\\n  @media (max-width: \",\") {\\n    margin-left: 0px;\\n  }\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.breakpoints.md;});var BoxBody=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\"])));var StyledBoxContent=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n  margin-top: 27px;\\n\"])));var StyledRound=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  align-items: center;\\n  font-size: 24px;\\n  font-weight: bold;\\n  text-align: center;\\n  background-image: url(\",\");\\n  background-repeat: no-repeat;\\n  background-size: contain;\\n  img {\\n    height: 120px;\\n    margin-bottom: 18px;\\n  }\\n\"])),bgRound);var StyledCountdown=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  font-size: 28px;\\n  font-weight: normal;\\n  color: #f69963;\\n  margin-top: 20px;\\n  font-family: \",\";\\n  @media (max-width: \",\") {\\n    font-size: 20px;\\n  }\\n\"])),function(_ref5){var theme=_ref5.theme;return theme.font.heading;},function(_ref6){var theme=_ref6.theme;return theme.breakpoints.lg;});var StyledWinNumber=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  padding: 20px 58px;\\n  display: grid;\\n  grid-template-columns: auto auto auto auto auto;\\n  @media (max-width: \",\") {\\n    padding: 20px 18px;\\n  }\\n\"])),function(_ref7){var theme=_ref7.theme;return theme.breakpoints.lg;});var StyledWinNumberItem=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 86px;\\n  height: 86px;\\n  font-size: 48px;\\n  font-weight: bold;\\n  background-image: url(\",\");\\n  color: #000000;\\n  background-size: cover;\\n  background-repeat: none;\\n  margin: 0px 40px;\\n  &:last-child {\\n    background-image: url(\",\");\\n  }\\n  @media (max-width: \",\") {\\n    width: 50px;\\n    height: 50px;\\n    font-size: 30px;\\n    margin: 0px 10px;\\n  }\\n\"])),ImgBallNormal,ImgBallPower,function(_ref8){var theme=_ref8.theme;return theme.breakpoints.lg;});var StyledTable=styled.table(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  width: \",\";\\n  padding: 24px 58px;\\n  border-spacing: 0px;\\n  border: none;\\n  thead {\\n    th {\\n      width: 33%;\\n      padding: 6px 0px 0px 20px;\\n      background-color: #303030;\\n      font-size: 16px;\\n      font-weight: 500;\\n      color: #c3c4c5;\\n      :last-child {\\n        width: 10%;\\n      }\\n    }\\n  }\\n  tbody {\\n    td {\\n      padding: 8px 0px 0px 20px;\\n      font-size: 16px;\\n      font-weight: 600;\\n      span {\\n        font-weight: normal;\\n      }\\n    }\\n  }\\n  @media (max-width: \",\") {\\n    padding: 24px 18px;\\n  }\\n\"])),function(_ref9){var compact=_ref9.compact;return compact?'80%':'100%';},function(_ref10){var theme=_ref10.theme;return theme.breakpoints.lg;});","map":{"version":3,"sources":["/Users/ivopascoal/Desktop/cuffies/src/views/TicketDetail/TicketDetail.tsx"],"names":["React","useCallback","useEffect","useMemo","useState","Box","BoxHeader","Container","Page","styled","imageWin","imageClock","bgRound","NumberDisplay","NextDrawCountdown","useDiamondHand","TicketClaim","useRoundInfo","useHistory","useQuery","Status","TicketDetail","dh","history","query","undefined","currentRound","setCurentRound","roundId","setRoundId","currentPrize","setCurrentPrize","lotteryInfo","lotteryId","get","parseInt","LOTTERY","getCurrentLotto","then","data","lotteryID","toNumber","getCurrentPrizes","prizes","closing","closingTimestamp","isPastClosing","now","Date","tickets","temp","i","push","isClose","lotteryStatus","Completed","onSelect","event","target","value","imageTicket","map","item","index","numberOfTickets","winningNumbers","winners","toString","StyledHeader","div","theme","font","heading","StyledSelect","select","StyledContent","breakpoints","lg","BoxTitle","StyledNumberTicket","md","BoxBody","StyledBoxContent","StyledRound","StyledCountdown","StyledWinNumber","StyledWinNumberItem","ImgBallNormal","ImgBallPower","StyledTable","table","compact"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { Box, BoxHeader } from 'src/components/Box';\nimport Container from 'src/components/Container';\nimport Page from 'src/components/Page';\nimport styled from 'styled-components';\nimport imageTicket from '../../assets/img/ticket-white.svg';\nimport imageWin from '../../assets/img/image-win.webp';\nimport imageClock from '../../assets/img/img-clock.png';\nimport ImgBallNormal from 'src/assets/img/ball-normal-large.svg';\nimport ImgBallPower from 'src/assets/img/ball-power-large.svg';\nimport bgRound from '../../assets/img/bg_confirm.png';\nimport NumberDisplay from 'src/components/Number';\nimport NextDrawCountdown from '../DragonBall/components/NextDrawCountdown';\nimport useDiamondHand from 'src/hooks/useDiamondHand';\nimport TicketClaim from './components/TicketClaim';\nimport useRoundInfo from './hooks/useRoundInfo';\nimport { useHistory } from 'react-router-dom';\nimport useQuery from 'src/hooks/useQuery';\nimport { BigNumber } from 'ethers';\n\nenum Status {\n  NotStarted,\n  Open,\n  Closed,\n  Completed,\n}\n\nconst TicketDetail: React.FC = () => {\n  const dh = useDiamondHand();\n  const history = useHistory();\n  const query = useQuery();\n  const [currentRound, setCurentRound] = useState<number | undefined>(undefined);\n  const [roundId, setRoundId] = useState<number | undefined>(undefined);\n  const [currentPrize, setCurrentPrize] = useState<BigNumber[]>([]);\n  const lotteryInfo = useRoundInfo(roundId);\n\n  useEffect(() => {\n    const lotteryId = query?.get('lotteryId');\n    setRoundId(parseInt(lotteryId) || 0);\n  }, [query]);\n\n  useEffect(() => {\n    if (!dh) return;\n    dh?.LOTTERY?.getCurrentLotto().then((data) => {\n      setCurentRound(data.lotteryID.toNumber());\n    });\n    dh?.LOTTERY?.getCurrentPrizes().then((prizes) => {\n      setCurrentPrize(prizes);\n    });\n  }, [dh, history, roundId]);\n\n  const closing = useMemo(() => {\n    if (!lotteryInfo) {\n      return;\n    }\n    return lotteryInfo.closingTimestamp.toNumber() * 1000;\n  }, [lotteryInfo]);\n\n  const isPastClosing = useMemo(() => {\n    const now = Date.now();\n    if (closing) {\n      return now - closing > 0;\n    }\n  }, [closing]);\n\n  const tickets = useMemo(() => {\n    const temp: number[] = [];\n    if (!currentRound) {\n      return temp;\n    }\n    for (let i = 1; i <= currentRound; i++) {\n      temp.push(i);\n    }\n    return temp;\n  }, [currentRound]);\n\n  const isClose = useMemo(() => {\n    if (!lotteryInfo) {\n      return false;\n    }\n    return lotteryInfo.lotteryStatus === Status.Completed;\n  }, [lotteryInfo]);\n\n  const onSelect = useCallback(\n    (event) => {\n      history.push(`?lotteryId=${event.target.value}`);\n    },\n    [history],\n  );\n\n  return (\n    <Page>\n      <Container size=\"lg\">\n        <StyledHeader>\n          <img src={imageTicket} />\n          RESULTS\n          <StyledSelect value={roundId} onChange={onSelect}>\n            {tickets.map((item, index) => (\n              <option key={index} value={item}>\n                Round {item}\n              </option>\n            ))}\n          </StyledSelect>\n        </StyledHeader>\n        <StyledContent>\n          <Box>\n            <BoxHeader>\n              <BoxTitle>Round {roundId}</BoxTitle>\n              <StyledNumberTicket>\n                Total of&nbsp;\n                <NumberDisplay\n                  value={lotteryInfo?.numberOfTickets}\n                  decimals={0}\n                  precision={0}\n                  keepZeros={true}\n                />\n                &nbsp;Tickets\n              </StyledNumberTicket>\n            </BoxHeader>\n            <BoxBody>\n              <StyledBoxContent>\n                <StyledRound>\n                  <img src={isClose ? imageWin : imageClock} />\n                  {isClose ? 'Winning Emojis' : 'Winning Emojis will be drawn in'}\n                </StyledRound>\n                {isClose ? (\n                  <StyledWinNumber>\n                    {lotteryInfo?.winningNumbers?.map((item, index) => (\n                      <StyledWinNumberItem key={index}>{item || 0}</StyledWinNumberItem>\n                    ))}\n                  </StyledWinNumber>\n                ) : (\n                  <StyledCountdown>\n                    {isPastClosing ? (\n                      <div>Awaiting for results...</div>\n                    ) : (\n                      <NextDrawCountdown to={closing ? new Date(closing) : undefined} />\n                    )}\n                  </StyledCountdown>\n                )}\n                <StyledTable compact={!isClose}>\n                  <thead>\n                    <tr>\n                      <th>Reward</th>\n                      <th>Reward Size</th>\n                      {isClose && <th>Winners</th>}\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td>JackPot</td>\n                      <td>\n                        <NumberDisplay\n                          value={\n                            roundId === currentRound && !isClose\n                              ? currentPrize[0]\n                              : lotteryInfo?.prizes[0]\n                          }\n                          decimals={18}\n                          precision={0}\n                          keepZeros={true}\n                        />\n                        <span>&nbsp;Cuffies</span>\n                      </td>\n                      {isClose && <td>{lotteryInfo?.winners[0]?.toString() ?? 0}</td>}\n                    </tr>\n                    <tr>\n                      <td>Match 4</td>\n                      <td>\n                        <NumberDisplay\n                          value={\n                            roundId === currentRound && !isClose\n                              ? currentPrize[1]\n                              : lotteryInfo?.prizes[1]\n                          }\n                          decimals={18}\n                          precision={0}\n                          keepZeros={true}\n                        />\n                        <span>&nbsp;Cuffies</span>\n                      </td>\n                      {isClose && <td>{lotteryInfo?.winners[1]?.toString() ?? 0}</td>}\n                    </tr>\n                    <tr>\n                      <td>Match 3</td>\n                      <td>\n                        <NumberDisplay\n                          value={\n                            roundId === currentRound && !isClose\n                              ? currentPrize[2]\n                              : lotteryInfo?.prizes[2]\n                          }\n                          decimals={18}\n                          precision={0}\n                          keepZeros={true}\n                        />\n                        <span>&nbsp;Cuffies</span>\n                      </td>\n                      {isClose && <td>{lotteryInfo?.winners[2]?.toString() ?? 0}</td>}\n                    </tr>\n                  </tbody>\n                </StyledTable>\n                {lotteryInfo && <TicketClaim roundId={roundId} isCloseRound={isClose} />}\n              </StyledBoxContent>\n            </BoxBody>\n          </Box>\n        </StyledContent>\n      </Container>\n    </Page>\n  );\n};\n\nexport default TicketDetail;\n\nconst StyledHeader = styled.div`\n  display: flex;\n  align-items: center;\n  font-size: 32px;\n  font-weight: 600;\n  font-family: ${({ theme }) => theme.font.heading};\n  border-bottom: 2px dashed #303030;\n  padding: 20px 0px 16px 0px;\n  img {\n    width: 38px;\n    margin-right: 12px;\n  }\n`;\n\nconst StyledSelect = styled.select`\n  margin-left: auto;\n  padding: 5px 6px;\n  border: solid 2px #12161e;\n  background-color: #12161e;\n  font-size: 16px;\n  font-weight: 600;\n  color: #ffffff;\n`;\n\nconst StyledContent = styled.div`\n  margin: 27px 60px 0px 60px;\n  @media (max-width: ${({ theme }) => theme.breakpoints.lg}) {\n    margin: 27px 0px 0px 0px;\n  }\n`;\n\nconst BoxTitle = styled.div`\n  font-family: ${({ theme }) => theme.font.heading};\n  font-size: 24px;\n  font-weight: 600;\n`;\n\nconst StyledNumberTicket = styled.div`\n  margin-left: auto;\n  font-size: 16px;\n  font-weight: 600;\n  @media (max-width: ${({ theme }) => theme.breakpoints.md}) {\n    margin-left: 0px;\n  }\n`;\n\nconst BoxBody = styled.div``;\n\nconst StyledBoxContent = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  margin-top: 27px;\n`;\n\nconst StyledRound = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  font-size: 24px;\n  font-weight: bold;\n  text-align: center;\n  background-image: url(${bgRound});\n  background-repeat: no-repeat;\n  background-size: contain;\n  img {\n    height: 120px;\n    margin-bottom: 18px;\n  }\n`;\n\nconst StyledCountdown = styled.div`\n  font-size: 28px;\n  font-weight: normal;\n  color: #f69963;\n  margin-top: 20px;\n  font-family: ${({ theme }) => theme.font.heading};\n  @media (max-width: ${({ theme }) => theme.breakpoints.lg}) {\n    font-size: 20px;\n  }\n`;\n\nconst StyledWinNumber = styled.div`\n  padding: 20px 58px;\n  display: grid;\n  grid-template-columns: auto auto auto auto auto;\n  @media (max-width: ${({ theme }) => theme.breakpoints.lg}) {\n    padding: 20px 18px;\n  }\n`;\n\nconst StyledWinNumberItem = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 86px;\n  height: 86px;\n  font-size: 48px;\n  font-weight: bold;\n  background-image: url(${ImgBallNormal});\n  color: #000000;\n  background-size: cover;\n  background-repeat: none;\n  margin: 0px 40px;\n  &:last-child {\n    background-image: url(${ImgBallPower});\n  }\n  @media (max-width: ${({ theme }) => theme.breakpoints.lg}) {\n    width: 50px;\n    height: 50px;\n    font-size: 30px;\n    margin: 0px 10px;\n  }\n`;\n\nconst StyledTable = styled.table<{ compact?: boolean }>`\n  width: ${({ compact }) => (compact ? '80%' : '100%')};\n  padding: 24px 58px;\n  border-spacing: 0px;\n  border: none;\n  thead {\n    th {\n      width: 33%;\n      padding: 6px 0px 0px 20px;\n      background-color: #303030;\n      font-size: 16px;\n      font-weight: 500;\n      color: #c3c4c5;\n      :last-child {\n        width: 10%;\n      }\n    }\n  }\n  tbody {\n    td {\n      padding: 8px 0px 0px 20px;\n      font-size: 16px;\n      font-weight: 600;\n      span {\n        font-weight: normal;\n      }\n    }\n  }\n  @media (max-width: ${({ theme }) => theme.breakpoints.lg}) {\n    padding: 24px 18px;\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}